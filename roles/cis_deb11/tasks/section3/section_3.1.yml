- name: "3.1.1 Ensure system is checked to determine if IPv6 is enabled (Manual)"
  block:
    - name: "3.1.1 | disable ipv6 in grub"
      replace: dest="/etc/default/grub" regexp='^GRUB_CMDLINE_LINUX="(((?!ipv6.disable=).)*)"$' replace='GRUB_CMDLINE_LINUX="\1 ipv6.disable=1"'
      notify: "update grub"
      notify: "reboot"

    - name: "3.1.1 | disable ipv6 in sysctl"
      block:
        sysctl:
          name: net.ipv6.conf.all.disable_ipv6
          value: '1'
          state: present
          reload: true
          sysctl_set: true
          ignoreerrors: true
        sysctl:
          name: net.ipv6.conf.default.disable_ipv6
          value: '1'
          state: present
          reload: true
          sysctl_set: true
          ignoreerrors: true
        sysctl:
          name: net.ipv6.route.flush
          value: '1'
          state: present
          reload: true
          sysctl_set: true
          ignoreerrors: true
      notify: "reboot"


#- name: "3.1.2 Ensure wireless interfaces are disabled (Automated)"
#  block:
#    command: "nmcli radio all off"
  when: level1|bool