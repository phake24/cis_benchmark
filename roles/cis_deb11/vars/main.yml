---
# need to be adjusted:

root_password: root_pass2022!
povadmin_password: povadmin_pass2022!

ntp_server_list: 1.11.5.37 1.11.5.36 # seperated by spaces
ntp_fallback_server_list: 1.50.1.68 1.50.1.69 # seperated by spaces

ntp_server_primary: 1.11.5.37
ntp_server_secondary: 1.11.5.36

level1: True
level2: True

SyslogServerPrimary: 1.50.1.108
SyslogServerPrimaryPort: 514
SyslogServerPrimaryProto: tcp
SyslogServerPrimaryRetryCount: 100
SyslogServerPrimaryQueueSize: 1000
SyslogServerSecondary: 1.50.2.212
SyslogServerSecondaryPort: 514
SyslogServerSecondaryProto: tcp
SyslogServerSecondaryRetryCount: 100
SyslogServerSecondaryQueueSize: 1000

sshd_allow_groups: povadmin nagios # maybe add relevant SBG, seperated by space
sshd_allowed_ciphers: chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr
sshd_allowed_macs: hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,hmac-sha2-512,hmac-sha2-256
sshd_allowed_kexalgorithm: curve25519-sha256,curve25519-sha256@libssh.org,diffie-hellman-group14-sha256,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,ecdh-sha2-nistp521,ecdh-sha2-nistp384,ecdh-sha2-nistp256,diffie-hellman-group-exchange-sha256
sshd_loglevel: INFO # valid values: INFO or VERBOSE

debian_repository_hostname: de-vpc-fravc-spm-001
debian_repository_port: 8443

configure_nagios: True # or False
nagios_host_ip1: 1.11.0.133

enable_coredumps: False
enable_firewall: False # True or False  

enable_apparmor: True
enable_apparmor_complain: False   # only possible for Level 1
enable_apparmor_enforce: True     # forced for Level 2

enable_logging_journald_remote: False # True or False
enable_logging_journald_remote_server: 192.168.1.1 # journald remote server address
enable_logging_journald_remote_ServerKeyFilePath: /etc/ssl/private/journal-upload.pem
enable_logging_journald_remote_ServerCertPath: /etc/ssl/certs/journal-upload.pem
enable_logging_journald_remote_TrustCertPath: /etc/ssl/ca/trusted.pem
enable_logging_jounrald_remote_ServerKey: 
enable_logging_jounrald_remote_ServerCert: 
enable_logging_jounrald_remote_TrustCert: 

minimum_password_length: 14
maximum_allowed_false_logins: 4 # not greater than4! Deny access if the number of consecutive authentication failures for this user during "maximum_allowed_false_logins" n tries
false_login_fail_interval: 900 # not greather tha 900
false_login_unlock_time: 600 # not greater than 600


content_login_banner: |
  ############################>>>>>#############################
  ###            This system is private property of          ###
  ###        Deutsche Telekom Buisness Solutions GmbH.       ###
  ###                                                        ###
  ### Only authorized access to this system is allowed. All  ###
  ### activities on this system are monitored. By continuing ###
  ### activities on this system, you accept this rules.      ###
  ###                                                        ###
  ### WARNING!                                               ###
  ### Any unauthorized access to this system is strictly     ###
  ### prohibited and will be prosecuted to the full extend   ###
  ### of applicable local and international law.             ###
  ###########################<<<<<##############################


## be carefull with following parameters

hardening_version: v2.0
hardening_date: 28.09.2022

ansible_user: ansible
ansible_password: ansible
ansible_become_method: su
ansible_become_password: ansible
hardening_header: |
  # {{ ansible_os_family }}-Linux Hardening {{ hardening_version }}
  #
  # Ansible managed: modified on {{ ansible_date_time }}
  #
  # Date {{ hardening_date }}

grub_v2_user: root
grub_v2_password: blubb
grub_password_v2_unrestricted: True
grub_password_unrestricted_files: 
  - /etc/grub.d/10_linux
grub_v2_password_script: "/tmp/grub_v2_passwd.sh"

systemd_coredump_config_file: /etc/systemd/coredump.conf
security_hardlimits_config_file: /etc/security/limits.d/hardlimits.conf

auditd_log_file: /var/log/audit/audit.log
auditd_max_log_file: 10 # default 8MB
auditd_num_logs: 20
auditd_space_left: 75
auditd_space_left_action: SYSLOG
auditd_admin_space_left: 50
auditd_admin_space_left_action: halt # halt or single are allowed
auditd_disk_full_action: SUSPEND


## Debian specific

debian_grub_file_user_config: "/etc/grub.d/40_custom"

## Oracle specific

selinux_mode: enforcing # enforcing OR permissive allowed in level1, level2 is forced to enforcing.


dnf_delete_repos: 1
dnf_nagios_enabled: 0
dnf_nagios_repo: https://de-vpc-fravc-spm-007:8443/repo/Nagios/VPP_ol8_nagios/
dnf_nagios_deps_enabled: 0
dnf_nagios_deps_repo: https://de-vpc-fravc-spm-007:8443/repo/Nagios/VPP_ol8_nagiosxi-deps/
dnf_nagios_gpg: https://de-vpc-fravc-spm-007:8443/gpg/ol8_GPG-KEY-NAGIOS-V2
dnf_postgresql10_enabled: 0
dnf_postgresql10_repo: https://de-vpc-fravc-spm-007:8443/repo/postgreSQL/VPP_ol8_pgdg10/
dnf_postgresql10_gpg: https://de-vpc-fravc-spm-007:8443/gpg/ol8_RPM-GPG-KEY-PGDG
dnf_postgresql11_enabled: 0
dnf_postgresql11_repo: https://de-vpc-fravc-spm-007:8443/repo/postgreSQL/VPP_ol8_pgdg11/
dnf_postgresql11_gpg: https://de-vpc-fravc-spm-007:8443/gpg/ol8_RPM-GPG-KEY-PGDG
dnf_postgresql12_enabled: 0
dnf_postgresql12_repo: https://de-vpc-fravc-spm-007:8443/repo/postgreSQL/VPP_ol8_pgdg12/
dnf_postgresql12_gpg: https://de-vpc-fravc-spm-007:8443/gpg/ol8_RPM-GPG-KEY-PGDG
dnf_postgresql13_enabled: 0
dnf_postgresql13_repo: https://de-vpc-fravc-spm-007:8443/repo/postgreSQL/VPP_ol8_pgdg13/
dnf_postgresql13_gpg: https://de-vpc-fravc-spm-007:8443/gpg/ol8_RPM-GPG-KEY-PGDG
dnf_postgresql14_enabled: 0
dnf_postgresql14_repo: https://de-vpc-fravc-spm-007:8443/repo/postgreSQL/VPP_ol8_pgdg14/
dnf_postgresql14_gpg: https://de-vpc-fravc-spm-007:8443/gpg/ol8_RPM-GPG-KEY-PGDG
dnf_postgresql_common_repo: https://de-vpc-fravc-spm-007:8443/repo/postgreSQL/VPP_ol8_pgdg-common/
dnf_postgresql_common_gpg: https://de-vpc-fravc-spm-007:8443/gpg/ol8_RPM-GPG-KEY-PGDG
dnf_shibboleth_enabled: 0
dnf_shibboleth_repo: https://de-vpc-fravc-spm-007:8443/repo/Shibboleth/VPP_ol8_shibboleth
dnf_shibboleth_gpg: https://de-vpc-fravc-spm-007:8443/gpg/ol8_RPM-GPG-KEY-Shibboleth
dnf_icinga_enabled: 0
dnf_icinga_repo: https://de-vpc-fravc-spm-007:8443/repo/icinga2/VPP_ol8_icinga2
dnf_icinga_gpg: https://de-vpc-fravc-spm-007:8443/gpg/ol8_RPM-GPG-KEY-ICINGA2
