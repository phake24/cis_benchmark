- name: "1.1.10 Disable USB Storage (Automated)"
  become: yes
  vars:
      usb_storage_config: "/etc/modprobe.d/usb-storage.conf"
  block:
    - name: "1.1.10 Disable USB Storage (Automated) |-> Disabling usb-storage"
      modprobe: 
        name: usb-storage
        state: absent
    - name: "1.1.10 Disable USB Storage (Automated) |-> Writing {{ usb_storage_config }}"
      copy:
        dest: "{{ usb_storage_config }}"
        content: |
             # {{ usb_storage_config }}
             #
             # {{ hardening_header }}
             install usb-storage /bin/true
             blacklist usb-storage
        mode: 0644
        owner: root
        group: root
  when: level1|bool == True
  tags:
    - section1
    - section1.1
    - section1.1.10
